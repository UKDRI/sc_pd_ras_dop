# -*- org-confirm-babel-evaluate: nil -*-
#+TITLE: ParkinsonPathAI (Working title) - AI Models for Pathway Analysis in Parkinson’s Disease
#+OPTIONS: ^:nil
#+Author: Sam Neaves

* Introduction

This project focuses on analyzing single-cell transcriptomic data from
brain cells of both control and Parkinson’s disease donors. Our goal
is to characterize the complex interplay between the RAS and dopamine
pathways, we will attempt to do this using symbolic AI techniques. By employing methods like
descriptive rule induction, causal analysis, and model
building/repair, we aim to identify and understand unique cell states
associated with Parkinson’s disease.

Our approach reconciles gene networks with experimental data, allowing
us to reason about network consistency and potentially discover key
molecular signatures involved in disease progression. This repository will
contain code, data preprocessing steps, and model implementation
details for this exploratory analysis.

This is an open scientific project, actively developed in the
open-source community and a continuous work in progress. As the
results are preliminary, they may evolve over time with further
analysis and validation. If you spot any errors or have suggestions,
please feel free to open an issue. Contributions and feedback from the
community are welcome to help improve and refine our understanding of
the RAS and dopamine pathways in Parkinson’s disease.

* Data

Biological cell samples were collected postmortem from the ventral
substantia nigra of seven control samples, nine Parkinson's disease
samples, and four samples from patients with Incidental Lewy Body
Disorder. The nuclei of these cells were extracted and sequenced,
totaling 23,885 nuclei. The sequecning was deep and full
length. [INSERT DETALS OF SEQUENCING TECH OR REFERNCE]

** System biology approach

Our approach to this analysis is grounded in symbolic systems
biology. In systems biology, our goal is to understand and model
biological reality at a systems level. This means focusing on how
multiple aspects of biology interact to produce observable outcomes,
contrasting with traditional approaches that isolate individual
phenomena. Symbolic systems biology differs from quantitative systems
biology in the level of abstraction it applies.


Using discrete symbols to represent components of the system, rather
than specific quantities, offers several advantages. First,
abstracting measured data into symbolic form allows us to manage noise
in the data. Second, this abstraction reduces the size of the state
space we analyze, making certain computational methods more
feasible. Third, our goal is not only to understand the system but
also to control it. Therefore, it’s essential that our models and
their dynamics are interpretable, allowing suggested interventions and
their potential consequences to be validated in a laboratory setting.


Finally, there is evidence that symbolic abstraction is sufficient to
model biological dynamics in many cases.


Biological reality is highly complex. While the central dogma—DNA
transcribed to RNA, translated to protein—outlines the basic process
of cellular maintenance and control, the specifics of transcription,
translation, and metabolic pathways leading to disease are intricate
and require further exploration.


For instance, in somatic cells, DNA remains stable as cells
replicate. Differences between cells arise through processes such as
differentiation and gene regulation. Transcription can occur in
bursts, and alternative splicing allows for multiple proteins from a
single gene. Additionally, protein complexes may form with the aid of
chaperones, and epigenetic mechanisms, such as methylation and histone
modification, affect gene accessibility.




*** Intreptation of sequence data as instances in state space.

In our analysis of transcriptome from nuclei, previous work has
identified cell types using x method.
In addition cell states have been identified by y method.

** RAS MAPK pathway

In this work we are intrested in these pathways and the interplay.

I obtained two lists of genes from the two pathways from a collegue
(Viola - check where she got them from).
In order to get a full list of genes that we are intreseted in and their
interactions, we augment our intital list and query pathway commons to
obtain a network of genes. We use the pyBravo tool to make this query.

The intial list is :

Raas genes:
#+begin_src bash :results output :exports both
  cat ./data/initial_gene_list_files/raas_genes.txt
#+end_src

#+RESULTS:
#+begin_example
ACE
ADCY
AGTR1
AGTR2
AGT
ATF2
CCL2
CCL5
DAG1
ELK1
ERK1
ERK2
FOS
GNAQ
GRB2
IP3
JAK2
JNK
JUN
MAP2K1
MAP2K2
MAP2K4
MAP3K1
NFKB1
NO
NOX1
MAPK
PAK
PGE2
PI3K
PIP2
PKA
PKC
PLCG1
PTGER2
PTK2
PTK2B
PTPN6
RAC1
RAF1
HRAS
KRAS
REN
SHC1
SOS1
STAT1
STAT3
TNF
#+end_example

Dopamine KEGG pathway:

#+begin_src bash :results output :exports both
  cat ./data/initial_gene_list_files/DopamineKEGGpathway.txt
#+end_src

#+RESULTS:
#+begin_example
AKT3
CREB3
GNB5
ADCY5
COMT
CREB1
ATF2
ATF6B
MAPK14
CREB3L4
CALML6
DDC
DRD1
DRD2
DRD3
DRD4
DRD5
AKT1
AKT2
LRTOMT
PLCB1
FOS
GNAI1
GNAI2
GNAI3
GNAL
GNAQ
GNAO1
GNAS
GNB1
GNB2
GNB3
GNG3
GNG4
GNG5
GNG7
GNG10
GNG11
GNGT1
GNGT2
PPP2R3B
GRIA1
GRIA2
GRIA3
GRIA4
GRIN2A
GRIN2B
GSK3A
GSK3B
ITPR1
ITPR2
ITPR3
KCNJ3
KCNJ5
KCNJ6
KCNJ9
KIF5A
KIF5B
KIF5C
ARNTL
ARRB1
ARRB2
MAOA
MAOB
ATF4
CALY
GNG13
CALML5
PLCB2
PLCB3
PLCB4
GNG2
PPP1CA
PPP1CB
PPP1CC
PPP2R3C
PPP2CA
PPP2CB
PPP2R1A
PPP2R1B
PPP2R2A
PPP2R2B
PPP2R2C
PPP2R3A
PPP2R5A
PPP2R5B
PPP2R5C
PPP2R5D
PPP2R5E
PPP3CA
PPP3CB
PPP3CC
PRKACA
PRKACB
PRKACG
PRKCA
PRKCB
PRKCG
PPP2R2D
GNG12
MAPK8
MAPK11
MAPK13
GNB4
MAPK12
SCN1A
CREB3L2
SLC6A3
TH
CACNA1A
CACNA1B
CACNA1C
CACNA1D
CALM1
CALM2
CALM3
CALML3
CAMK2A
CAMK2B
CAMK2D
CAMK2G
PPP1R1B
CREB3L3
CREB3L1
CALML4
GNG8
CLOCK
CREB5
SLC18A2
SLC18A1
MAPK9
MAPK10

#+end_example

These were provided by Viola.

The intersection of these files is:
#+begin_src bash :results output :exports both
  grep -Fxf ./data/initial_gene_list_files/DopamineKEGGpathway.txt ./data/initial_gene_list_files/raas_genes.txt
#+end_src

#+RESULTS:
: ATF2
: FOS
: GNAQ

The union of these files is:

#+begin_src bash :results output :export both
  cat ./data/initial_gene_list_files/DopamineKEGGpathway.txt ./data/initial_gene_list_files/raas_genes.txt | sort | uniq | tee ./data/initial_gene_list_files/initial_gene_list.txt
  wc -l ./data/initial_gene_list_files/initial_gene_list.txt
#+end_src

#+RESULTS:
#+begin_example

ACE
ADCY
ADCY5
AGT
AGTR1
AGTR2
AKT1
AKT2
AKT3
ARNTL
ARRB1
ARRB2
ATF2
ATF4
ATF6B
CACNA1A
CACNA1B
CACNA1C
CACNA1D
CALM1
CALM2
CALM3
CALML3
CALML4
CALML5
CALML6
CALY
CAMK2A
CAMK2B
CAMK2D
CAMK2G
CCL2
CCL5
CLOCK
COMT
CREB1
CREB3
CREB3L1
CREB3L2
CREB3L3
CREB3L4
CREB5
DAG1
DDC
DRD1
DRD2
DRD3
DRD4
DRD5
ELK1
ERK1
ERK2
FOS
GNAI1
GNAI2
GNAI3
GNAL
GNAO1
GNAQ
GNAS
GNB1
GNB2
GNB3
GNB4
GNB5
GNG10
GNG11
GNG12
GNG13
GNG2
GNG3
GNG4
GNG5
GNG7
GNG8
GNGT1
GNGT2
GRB2
GRIA1
GRIA2
GRIA3
GRIA4
GRIN2A
GRIN2B
GSK3A
GSK3B
HRAS
IP3
ITPR1
ITPR2
ITPR3
JAK2
JNK
JUN
KCNJ3
KCNJ5
KCNJ6
KCNJ9
KIF5A
KIF5B
KIF5C
KRAS
LRTOMT
MAOA
MAOB
MAP2K1
MAP2K2
MAP2K4
MAP3K1
MAPK
MAPK10
MAPK11
MAPK12
MAPK13
MAPK14
MAPK8
MAPK9
NFKB1
NO
NOX1
PAK
PGE2
PI3K
PIP2
PKA
PKC
PLCB1
PLCB2
PLCB3
PLCB4
PLCG1
PPP1CA
PPP1CB
PPP1CC
PPP1R1B
PPP2CA
PPP2CB
PPP2R1A
PPP2R1B
PPP2R2A
PPP2R2B
PPP2R2C
PPP2R2D
PPP2R3A
PPP2R3B
PPP2R3C
PPP2R5A
PPP2R5B
PPP2R5C
PPP2R5D
PPP2R5E
PPP3CA
PPP3CB
PPP3CC
PRKACA
PRKACB
PRKACG
PRKCA
PRKCB
PRKCG
PTGER2
PTK2
PTK2B
PTPN6
RAC1
RAF1
REN
SCN1A
SHC1
SLC18A1
SLC18A2
SLC6A3
SOS1
STAT1
STAT3
TH
TNF
     178 ./data/initial_gene_list_files/initial_gene_list.txt
#+end_example

Next in order to understand which other genes have known interactions
with this list and how this list is related we query pathway commons
using pybravo.

For Pybravo to function, it must connect to a SPARQL endpoint from
Pathway Commons. Unfortunately, this resource can be unreliable at
times. However, it’s possible to set up a local SPARQL endpoint by
building a Docker container. A Docker recipe file is available in this
GitHub repository:

https://github.com/mkarikom/PathwayCommons-VOS#pathwaycommons-v12-on-virtuoso-7

With Pybravo installed and an appropriate Conda environment set up, we
can configure Pybravo to connect to our local instance of the Pathway
Commons SPARQL endpoint for querying.


We have set up the command to run from a Biomake file (makeprog in the
scripts directory).



#+begin_src bash :dir "./scripts/" :exports both :eval query :results output
  biomake "augment_gene_list" | tail -n 40
#+end_src

#+RESULTS:
#+begin_example
--- Upstream regulation network in 68.57 seconds ---
Number of nodes = 1339
Number of edges = 12032
SIF network written to ../data/pybravo_output/expanded_reg.sif
Basic regulation reaction provenance written to ../data/pybravo_output/expanded_reg-provenance.csv

| Node | Degree Centrality |
|------|------|
| NOG | 0.264 | 
| SP1 | 0.182 | 
| LEF1 | 0.17 | 
| MAZ | 0.168 | 
| TCF3 | 0.155 | 
| FOXO4 | 0.143 | 
| TGFB1 | 0.138 | 
| JUN | 0.136 | 
| MYC | 0.128 | 
| PAX4 | 0.123 | 

--- Network simplification in 2.49 seconds ---
SIF network written to ../data/pybravo_output/expanded_reg-unified.sif
Basic regulation reaction provenance written to ../data/pybravo_output/expanded_reg-unified-provenance.csv
Nodes after simplification = 1229
Edges after simplification = 11912

| Node | Degree Centrality |
|------|------|
| NOG | 0.276 | 
| DAND5 | 0.195 | 
| LEF1 | 0.182 | 
| MAZ | 0.178 | 
| TCF7L1 | 0.176 | 
| FOXO4 | 0.155 | 
| JUN | 0.151 | 
| TGFB1 | 0.149 | 
| HNF1A | 0.149 | 
| PVT1 | 0.139 | 


Target augment_gene_list built
#+end_example




This results in the creation of four files in the pybravo_output dir

expanded_reg_md10-provenance.csv
expanded_reg_md10-unified-provenance.csv expanded_reg_md10-unified.sif
expanded_reg_md10.sif

The expanded_reg_md10-unified.sif file can be viewed in cyto scape.

#+CAPTION: Gene Regulation Network
#+NAME:   fig:1
[[./data/plots/expanded_reg_md10-unified.png]]





** Subgroup discovery of celluar states


As a first step in our analysis, we take inspiration from an approach
used by WWII bomber command to improve aircraft survivability. The
story goes that analysts examined planes returning to England to see
where they had sustained damage. They inferred that planes could
survive damage in these areas, so to improve survivability, they added
armor to areas where damage had not been observed, presuming planes
hit in these unscathed areas did not return. This concept, known as
"survivorship bias," helps us focus on the states that are less likely
to survive or, in our case, cells lost in disease.


#+CAPTION: A 'State' of a surviving bomber
#+NAME:   fig:2
#+ATTR_ORG: :width "50"
#+ATTR_HTML: :width "100px"
[[./data/plots/Survivorship-bias.png]]



In our analogy, dopaminergic neurons (DNs) are known to be lost in
Parkinson’s disease. Therefore, cell states we observe in Parkinson’s
patients represent neurons that have managed to survive the
disease. Unlike bomber command who did not have access to planes that
did not return we also have access to data from control (CTRL)
individuals who do not have Parkinson’s disease, which we use as a
proxy for healthy neuron states.


Our goal is to identify descriptions—defined as combinations of gene
expression levels—that select subgroups of cell states with
statistically distinct patterns compared to the overall population of
cells. Specifically, we want to identify cellular states that are
common in CTRL samples but absent in Parkinson’s patients, aiming to
uncover features that may correlate with cell survival.

Once we have done this, we will be able to order cellular states using
pseudo time methods and try to understand why healthy peoples cells
are able to transistion into these states but people with parkinsons
disease are not.

To achieve this first step of identifying cellular states that appear
in CTRLS but not parkinson patients, we employ subgroup discovery, a data mining task
first described by Wrobel et al., which lies at the intersection of
classification and clustering. Subgroup discovery uses labeled data as
in classification, but its purpose is to describe statistically
interesting instances within these groups, aiming for descriptions
that are both interpretable and informative.


Subgroup discovery has previously been used in bioinformatics to
analyze gene expression, in tasks similar to gene set enrichment
analysis (GSEA). In GSEA, genes are instances, their descriptions are
annotations (such as GO terms), and labels are binary (e.g.,
differentially expressed or not). In contrast, our instances are cells
(or nuclei), our labels are CTRL or Parkinson’s, and our features are
gene expression values. Our goal is to identify and describe subgroups
of cellular transcriptomic states that are prominent in CTRL samples
but absent in Parkinson’s patients, potentially uncovering gene
expression profiles linked to neuron survival.


For this initial analysis, we limit subgroup discovery to a
propositional data mining task, focusing on attributes at the
individual cell level. While we do not yet incorporate relational
information available from Pathway Commons, such relationships could
provide valuable context in the future. Exploring this would require
methods like Relational Subgroup Discovery (RSD) or potentially
Hedwig. Currently, we use the query to Pathway Commons, executed
through Pybravo, primarily as a feature selection technique to focus
on gene expressions of interest.


** Data info

"Just sending the single nuclei data for the dopaminergic neurons in our atlas as Caleb suggested.
The file “SNatlas_DaNs_seurat.RData” is in the usual Dropbox folder.
The Seurat object in it is called “sn_atlas_dans” and contains all
neurons across all disease stages and subtypes. You can access disease
by sn_atlas_dans$Disease and cell subtype by
sn_atlas_dans$CellSubType. And extract gene expression data as raw
counts genes_counts<-as.matrix(GetAssayData(sn_atlas_dans, slot =
"counts")) or normalised
genes_norm<-as.matrix(GetAssayData(sn_atlas_dans, slot = "data"))."



#+begin_src R :session :eval query 
  library(dplyr)
  library(Seurat)
  library(patchwork)

  data_location <- "/Users/samneaves/Documents/test_data/forSam/SNatlas_DaNs_seurat.RData"
  load(data_location)

#+end_src

#+RESULTS:
: sn_atlas_dans

#+begin_src R :session
head(sn_atlas_dans$CellSubType)
#+end_src

#+RESULTS:
| DaN_0 |
| DaN_0 |
| DaN_1 |
| DaN_1 |
| DaN_0 |
| DaN_0 |

*** Get the normalised expression values
#+begin_src R :session :results none
genes_norm<-as.matrix(GetAssayData(sn_atlas_dans, slot = "data"))
#+end_src

#+RESULTS:


*** Get the count expression values

#+begin_src R :session :results none
genes_counts<-as.matrix(GetAssayData(sn_atlas_dans, slot = "counts"))
#+end_src

** Finding the overlap of list of genes that we get back from pathway commons and our data
#+begin_src R :session :results output :exports both
  network_data <- read.table("./data/pybravo_output/expanded_reg_md10-unified.sif", quote = "", header = FALSE, stringsAsFactors = FALSE, sep = "\t")
  head(network_data)
  nodes <- unique(c(network_data$V1, network_data$V3))
#+end_src

#+RESULTS:
:         V1         V2     V3
: 1 Fra1/JUN ACTIVATION   CCL2
: 2 Fra1/JUN ACTIVATION   Fra1
: 3 Fra1/JUN ACTIVATION    IL6
: 4 Fra1/JUN ACTIVATION p14ARF
: 5 Fra1/JUN ACTIVATION   MMP9
: 6 Fra1/JUN ACTIVATION  CXCL8

#+begin_src R :session :results output :exports both
  length(nodes)
#+end_src

#+RESULTS:
: [1] 1053

#+begin_src R :session :exports both
  # Convert the rownames of genes_counts into a vector
  genes_names <- rownames(genes_counts)

  # Get the intersection between the 'name' column in node_table and the rownames of genes_counts_subset_df
  common_names <- intersect(nodes, genes_names)

  # View the result
  length(common_names)
#+end_src

#+RESULTS:
: 526


In the graph representation we have genes and protein complexes.
A protein complex node is represented by Item/Item. For example

SMAD3/SMAD4/JUN/FOS

When we match our gene expression data to the network. These nodes
will be unobserved. We will need to infer if they are able to
form/activate.

In the way that the pybravo paper describes these nodes are used in
there iggy analysis. The 'part_of' edge is treated as plus. But I think the standard consistency
check is only looking for at least one positive edge to label a node
as consistant So not sure if that is appropiate. (will add detail to
this point later).

For the time being the number of complexes seem to be :

#+begin_src R :session :exports both
# Identify rows in the 'name' column that contain '/'
complexes <- grep("/", nodes)

# Count the number of complexes
num_complexes <- length(complexes)

# View the count
num_complexes
#+end_src

#+RESULTS:
: 296

#+begin_src R :session :exports both
# Count occurrences of each edge type in the second column (V2)
edge_counts <- table(network_data$V2)

# Display the counts of each edge type
print(edge_counts)
#+end_src

#+RESULTS:
| ACTIVATION | 1710 |
| INHIBITION |  655 |
| PART_OF    |  567 |
| UNKNOWN    |   95 |


#+begin_src R :session :exports both
  str(sn_atlas_dans)
  summary(sn_atlas_dans)
#+end_src

#+RESULTS:

We want to select Cells that are either control or parkinsons
We want to only select the genes that are in our network.
#+begin_src R :session :exports both
  sn_atlas_dans_ctrl_vs_pd <- subset(sn_atlas_dans, subset = Disease %in% c("CTR", "PD_B5-6", "PD_B3-4"))
  sn_atlas_dans_ctrl_vs_pd_pathway <- sn_atlas_dans_ctrl_vs_pd[common_names,]
  dim(sn_atlas_dans_ctrl_vs_pd_pathway)

  
#+end_src

#+RESULTS:
|  526 |
| 6385 |

#+begin_src R :session :exports both

# Extract the expression matrix for the subset
expression_matrix <- as.data.frame(t(as.matrix(sn_atlas_dans_ctrl_vs_pd_pathway@assays$RNA@data)))

# Add Disease column from metadata
expression_matrix$Disease <- sn_atlas_dans_ctrl_vs_pd_pathway@meta.data$Disease

# Save to CSV
write.csv(expression_matrix, file = "./data/cell_expression_with_disease.csv", row.names = TRUE)


#+end_src

#+RESULTS:


#+begin_src R :session :exports both

# Extract the count matrix for the subset and transpose it for cells as rows
count_matrix <- as.data.frame(t(as.matrix(sn_atlas_dans_ctrl_vs_pd_pathway@assays$RNA@counts)))

# Add Disease column from metadata
count_matrix$Disease <- sn_atlas_dans_ctrl_vs_pd_pathway@meta.data$Disease

# Save to CSV
write.csv(count_matrix, file = "./data/cell_count_with_disease.csv", row.names = TRUE)

#+end_src

#+RESULTS:



#+begin_src python :session myorangesession  :exports both :results output :eval (conda-env-activate "orange3")
# Your Python code here
print("Hello from Conda environment woop!")

import os

conda_env = os.environ.get("CONDA_DEFAULT_ENV")
print(f"Current Conda environment: {conda_env}")

#+end_src

#+RESULTS:
: Hello from Conda environment woop!
: Current Conda environment: orange3

The following code makes sure orange know which attribute is class
#+begin_src python :session myorangesession :results output :exports both
  conda_env = os.environ.get("CONDA_DEFAULT_ENV")
  print(f"Current Conda environment second go: {conda_env}")
  import Orange
  from Orange.data import Domain, Table, StringVariable

  # Load the data
  data = Table("./data/cell_count_with_disease.csv")



  # Separate attributes and disease variable
  attributes = [attr for attr in data.domain.attributes if attr.name != "Disease"]
  disease = data.domain["Disease"]
  meta_var = StringVariable("ID")

  # Create a new domain with the disease column as the class variable
  new_domain = Domain(attributes, class_vars=disease,  metas=[meta_var])

  # Apply this new domain to your data
  data_with_class = Table.from_table(new_domain, data)

  # Add back the meta var
  data_with_class.metas = data.metas


  # Verify the domain and check the class variable
  print("New domain:", data_with_class.domain)
  print("Class variable:", data_with_class.domain.class_var)
  print("Class values:", data_with_class.domain.class_var.values)

#+end_src

#+RESULTS:
: Current Conda environment second go: orange3
: New domain: [CCL2, FOS, JUN, CREB1, SRF, ELK1, JDP2, HGF, SP1, VEGFA, TNF, AGTR1, INS, AKT1, NLRC5, TP63, NOG, ARRB1, TGFB1, IFNG, EPO, ATF4, EIF2A, ESR2, AHR, CALM3, CCL5, IL4, ALB, IL1B, S100B, HMGB1, LEP, IL17A, OSM, IL1A, IKBKB, CRP, VDR, SOD2, EGF, SLC6A3, TGFA, TNFSF11, F2, ADRB2, MFGE8, PIK3CA, IFNA1, JAK2, NR1I2, BCL2L1, IGF1, MAPK12, IAPP, SULF1, KRAS, PARP1, IGF1R, IL18, MAPK14, FN1, NFKB1, MAPK9, TP53, IGBP1, PPP3CA, CXCL12, CDKN1A, STAT3, NDFIP1, IFNB1, ESR1, NTN1, MPO, CCND1, C5, FOXO3, NQO1, IL33, PTGS2, SNCA, CLEC4E, IL15, TNFAIP3, CYP3A4, SHH, FGF8, CNTF, FOXP3, IL32, AGXT, GDNF, YAP1, IL23R, TYK2, SMAD3, SMAD4, RHOA, CD4, FOSB, E2F3, EGR4, EGR1, PPARA, NR3C1, CNR2, HRH2, PPARG, NFKBIA, TLR4, P2RY6, KAT2B, CREBBP, GATA3, PAK1, FOXA1, ENO1, MYCBP, IL6, FOXO4, RB1, HBP1, HDAC2, POU4F1, MITF, HIF1A, SLC39A8, CXCR4, CYP4Z1, CTNNB1, CGB3, TNFSF10, BMP4, CSF2, TAC1, ICAM1, ABCB4, GH1, IL5, ALPK1, IL2, CXCL8, MVK, FCER2, TP73, CD28, FOXO1, HMOX1, ELANE, BDNF, GHRL, DDB2, PTHLH, EDN1, CLPTM1L, CA9, EP300, TYMP, FSHB, MAP3K20, GNAQ, IL24, RNF34, IL6R, IGF2, BSG, PML, MAPT, PRKN, CD40LG, ERCC4, SIRT1, CITED2, NPM1, SOX30, SERPINB5, NGF, RB1CC1, MDM2, AKR1B1, TGFB2, ACTA2, STK11, SRSF2, RELA, DNMT3B, RASSF1, HDAC1, HRH4, TGIF1, FGF7, EZH2, TFAP2C, PTEN, HRAS, CDKN1B, GSN, KEAP1, E2F1, VEGFC, TLR2, PRODH, NFE2L2, PSEN2, SQSTM1, CYP1A1, PKM, DPP3, CYP1A2, BRCA1, RXRA, RHEB, SRC, NCOA6, SULT2A1, PPARGC1A, NR1H3, AR, TRIM33, MSI1, EGFR, BRAF, CXCR3, LY96, CYLD, FOXM1, CREM, PTPRH, ZBTB17, FGF13, AP1S1, S1PR3, ARNT, HDAC7, RBPJ, MAF, IRF4, PIM1, SKI, CEBPA, E2F4, JUND, TNIK, HES1, TLE1, AES, YY1, DVL3, JAK1, LCK, JAK3, TRRAP, TERT, DNMT3A, GFI1, IRF7, LEF1, TAF9, FOXG1, SSRP1, IL12A, IL12B, TRPV1, CD3D, CD3E, CD247, RNASEL, PDGFB, NFKB2, BCL3, GBA, NCOA1, CD44, GATA1, FOXA2, EOMES, EGR3, EGR2, ETS1, WT1, TWIST1, SNAI1, GATA2, IL13, IL1RN, CFD, BID, E4F1, EPAS1, HSPA1A, PLAUR, WNT3A, DHFR, IRF1, ADIPOQ, MMP9, TGFBI, CD2, NTS, PLA2G1B, KIT, MAP2K6, PPARD, ERCC6, OGT, CAV1, RALA, ATG7, LGALS1, ATG13, DHCR24, DDIT4, MUC1, ARSB, PROM1, JAG1, NCOA2, NFATC1, CSF1, RNF128, RBL1, FGF16, SMARCA4, RNF39, CPAMD8, HNF1A, LHB, COPS5, TCF7L2, SMARCA2, KAT2A, TCF7L1, NOC2L, IL27, ATF3, USF2, PARP14, BCL6, E2F6, IL4R, NFX1, TAF10, TAF12, PITX2, PTCH1, HTR2A, PTGER1, NR1H4, P2RY11, RELB, CYSLTR1, NRIP1, CTCF, ETS2, MEN1, GLI1, CHGA, THPO, KITLG, FASLG, HSF1, ATG5, CFTR, ADAR, FASN, TIMP1, HSPA5, HOXC4, KISS1, HHIP, TBX21, RNASEH2A, APP, PSEN1, RASSF3, NDUFA2, BRIP1, SPTLC3, INSR, PPIA, GLI3, KLF4, FAS, GLI2, CD82, PRKAA2, CEBPZ, TSHB, PTMA, CTGF, MTSS1, TXLNG, MLX, TRH, KAT5, RUVBL1, RUVBL2, SRPRA, TRIM28, AKT3, TH, SLC18A2, PCBP4, ACE, PTK2, ARNTL, COMT, STAT1, MAPK3, MAPK1, PRKCA, CALML4, CAMK2D, GNG11, GNG5, GSK3A, ITPR3, MAOB, LRTOMT, MAPK13, PLCB1, PPP1CA, PPP1CB, PRKACG, PTGER2, SHC1, VAT1, DAP, TP53BP1, ZNF225, AREG, ERAL1, MLXIPL, AKT2, CACNA1A, CALM1, CACNA1B, CAMK2G, CREB3L2, CREB5, DAG1, CREB3L4, DRD4, DRD2, GNAL, GNAI2, GNAS, GNAO1, GNG10, GNB5, GNG12, GNG2, GNG8, GNG7, GNG4, GRIA1, GNGT1, GRIA3, GRIA2, GRIA4, GRIN2A, GSK3B, ITPR1, ITPR2, KCNJ3, KIF5C, KIF5A, MAOA, MAPK10, MAPK8, PPP1R1B, PPP2CA, PPP2R2D, PPP2R1B, PPP2R2A, PPP2R2B, PPP2R2C, PPP2R5A, PPP2R5E, PPP2R5C, PPP3CC, PRKACB, PRKCB, SCN1A, HLA-DQB1, PRRT2, RNASE1, KCTD11, MPP2, RAD1, HEBP1, IL27RA, HDAC9, SCG2, ARRB2, CALML3, CALML5, CAMK2B, CREB3L1, GNB4, GNB3, KCNJ5, MAP3K1, MAPK11, PLCB4, CGB7, CGB5, CGB8, AHRR, DDC, KCNJ6, PPP2R5B, CAMK2A, CREB3L3, GNB1, PPP2CB, PPP2R5D, GRIP1, PRODH2, PEMT, SPEN, RAF1, LAP3, PTK2B, TPO | Disease] {ID}
: Class variable: Disease
: Class values: ('CTR', 'PD_B3-4', 'PD_B5-6')

My export to csv is weird. Ignore for the moment.
#+begin_src python :session myorangesession :results output :exports both
  import pandas as pd
  conda_env = os.environ.get("CONDA_DEFAULT_ENV")
  print(f"Current Conda environment second go: {conda_env}")

  disc = Orange.preprocess.Discretize()
  disc.method = Orange.preprocess.discretize.EntropyMDL()
  data_with_class_discrete = disc(data_with_class)
  data_with_class_discrete.save("./data/cell_count_with_disease_mdl_discrete2.tab")

  # Convert the Orange table to a pandas DataFrame
  data_df = pd.DataFrame(data_with_class_discrete.X, columns=[attr.name for attr in data_with_class_discrete.domain.attributes])

  # Add the class variable if it exists
  data_df[data_with_class_discrete.domain.class_var.name] = [str(val) for val in data_with_class_discrete.Y]

  # Save the DataFrame as a CSV file
  data_df.to_csv("./data/cell_count_with_disease_mdl_discrete.csv", index=False)

#+end_src

#+RESULTS:
: Current Conda environment second go: orange3


#+begin_src python :session myorangesession :results output :exports both


  print("Hello from third block")
  conda_env = os.environ.get("CONDA_DEFAULT_ENV")
  print(f"Current Conda environment second go: {conda_env}")
  import Orange
  print(Orange.version.version)
  learner = Orange.classification.CN2SDLearner()
  learner.rule_finder.search_algorithm.beam_width = 10
  learner.rule_finder.search_strategy.constrain_continuous = True
  learner.rule_finder.general_validator.min_covered_examples = 15
  learner.rule_finder.general_validator.max_rule_length = 6
  classifier = learner(data_with_class_discrete)
  for rule in classifier.rule_list:
     print(f"Rule: {rule}")
#+end_src

#+RESULTS:
#+begin_example
Hello from third block
Current Conda environment second go: orange3
3.36.2
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND IL27RA!=10.5 - 32.5 AND S100B==< 142.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 THEN Disease=CTR 
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND IL27RA!=10.5 - 32.5 AND S100B==< 142.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND CREB3L3!=5.5 - 40.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
Rule: IF GNAO1!=< 7.5 AND RNF128!=≥ 11.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 THEN Disease=CTR 
Rule: IF RXRA!=< 0.5 AND CYSLTR1!=≥ 6.5 AND PTMA==< 140.5 AND S100B==< 142.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 THEN Disease=CTR 
Rule: IF GNAO1!=< 7.5 AND MAOB==< 12.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND PTMA==< 140.5 THEN Disease=CTR 
Rule: IF RXRA!=< 0.5 AND CNR2!=12.5 - 58.5 AND S100B==< 142.5 AND PTMA==< 140.5 AND PPIA==< 248 AND CALM1==< 113.5 THEN Disease=CTR 
Rule: IF GNAO1!=< 7.5 AND RNF128!=≥ 11.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF GNAO1==< 7.5 AND CYSLTR1!=< 0.5 AND PPP2R2B==< 209.5 AND GSN!=≥ 95.5 AND HSPA1A!=≥ 6.5 AND RXRA!=8.5 - 71.5 THEN Disease=PD_B5-6 
Rule: IF RXRA!=< 0.5 AND IL23R!=≥ 9.5 AND CALM1==< 113.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
Rule: IF PPP2R2B==< 209.5 AND CYP3A4!=< 0.5 AND MAPT!=≥ 88.5 AND NFATC1!=≥ 65.5 AND KAT2B==< 60.5 AND RNASE1!=8.5 - 620 THEN Disease=PD_B5-6 
Rule: IF DNMT3A!=< 3.5 AND IL23R!=≥ 9.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND RNASE1!=≥ 620 THEN Disease=CTR 
Rule: IF PPP2R2B==< 209.5 AND AKT1==< 0.5 AND MAPT!=≥ 88.5 AND HSPA1A!=≥ 6.5 AND HHIP==< 11.5 AND RXRA!=8.5 - 71.5 THEN Disease=PD_B5-6 
Rule: IF FGF16==< 0.5 AND GNG7!=< 11.5 AND IL12B!=0.5 - 19 AND GNAS!=≥ 850 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF AR!=17.5 - 232.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
Rule: IF HSPA1A==< 0.5 AND CYSLTR1!=< 0.5 AND RNASE1==< 8.5 AND GNAO1!=≥ 157.5 AND ARRB1!=≥ 104.5 AND NFATC1!=≥ 65.5 THEN Disease=PD_B5-6 
Rule: IF GRIA3!=31.5 - 272 AND PPIA==< 248 AND GNAS!=≥ 850 AND CCL5==< 0.5 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
Rule: IF NFATC1!=< 4.5 AND CNR2!=12.5 - 58.5 AND GNAS!=≥ 850 THEN Disease=CTR 
Rule: IF HSPA1A==< 0.5 AND CYSLTR1!=< 0.5 AND NFATC1!=≥ 65.5 AND RNASE1==< 8.5 AND ARRB1!=≥ 104.5 AND NR3C1==< 130.5 THEN Disease=PD_B5-6 
Rule: IF HSPA1A!=< 0.5 AND KAT5==< 1.5 AND CA9==< 5.5 AND VEGFA!=≥ 12.5 AND CYSLTR1!=< 0.5 AND TGFB1==< 30.5 THEN Disease=PD_B3-4 
Rule: IF AR!=17.5 - 232.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF GRIA3!=31.5 - 272 AND PPIA==< 248 AND GNAS!=≥ 850 AND C5==< 83.5 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
Rule: IF GNB4==6.5 - 49.5 AND HHIP==< 11.5 AND NCOA1==< 166.5 AND NR3C1==< 130.5 AND PTK2B!=≥ 123.5 AND HSPA1A!=≥ 6.5 THEN Disease=PD_B5-6 
Rule: IF PPP2R2B==< 209.5 AND PIK3CA==2.5 - 57.5 AND NFATC1!=≥ 65.5 AND APP==< 132.5 AND ARRB1!=≥ 104.5 AND BCL2L1!=≥ 28.5 THEN Disease=PD_B5-6 
Rule: IF NFATC1!=< 4.5 AND RNASEH2A!=0.5 - 13.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND AKR1B1!=≥ 1202 AND AR!=≥ 232.5 THEN Disease=CTR 
Rule: IF HSPA1A!=< 0.5 AND KAT5==< 1.5 AND CA9==< 5.5 AND IL23R!=< 0.5 AND TGFB1==< 30.5 AND VEGFA!=≥ 12.5 THEN Disease=PD_B3-4 
Rule: IF RNASE1!=< 8.5 AND VEGFA!=≥ 12.5 AND GNG4!=≥ 77 AND DDB2==< 31.5 AND RXRA!=≥ 71.5 AND GATA3==< 28.5 THEN Disease=PD_B3-4 
Rule: IF AR!=17.5 - 232.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 AND EGF!=≥ 84.5 THEN Disease=CTR 
Rule: IF PTK2==< 198.5 AND PIK3CA==2.5 - 57.5 AND HSPA1A!=≥ 6.5 AND NR3C1==< 130.5 AND NFATC1!=≥ 65.5 AND PPP2R2D!=≥ 35.5 THEN Disease=PD_B5-6 
Rule: IF FGF16==< 0.5 AND GNG7!=< 11.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND AKR1B1!=≥ 1202 AND SLC18A2==< 44 THEN Disease=CTR 
Rule: IF HSPA1A!=< 0.5 AND KAT5==< 1.5 AND CA9==< 5.5 AND TGFB1==< 30.5 AND IL23R!=< 0.5 AND GNG12==< 137.5 THEN Disease=PD_B3-4 
Rule: IF TNFSF10!=< 0.5 AND ARRB1!=≥ 104.5 AND HSPA1A!=≥ 6.5 AND KIF5C!=≥ 106.5 AND NR3C1==< 130.5 AND JDP2!=≥ 37.5 THEN Disease=PD_B5-6 
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND FGF13!=≥ 335.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF ARRB1!=< 5.5 AND HLA-DQB1==< 0.5 AND GNAO1!=7.5 - 14.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND PPIA==< 248 THEN Disease=CTR 
Rule: IF PPP2R2B==< 209.5 AND RNASE1==< 8.5 AND NFATC1!=≥ 65.5 AND PPP2R2D!=≥ 35.5 AND PTK2==< 198.5 AND HSPA1A!=≥ 6.5 THEN Disease=PD_B5-6 
Rule: IF RNASE1!=< 8.5 AND VEGFA!=≥ 12.5 AND GNG4!=≥ 77 AND DDB2==< 31.5 AND RXRA!=≥ 71.5 AND CNR2!=≥ 58.5 THEN Disease=PD_B3-4 
Rule: IF TNFSF10==< 0.5 AND CD40LG==< 0.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND SRF!=≥ 45.5 THEN Disease=CTR 
Rule: IF DHFR!=< 4.5 AND ARRB1!=≥ 104.5 AND HSPA1A!=≥ 6.5 AND MAPK8==< 171 AND KIF5C!=≥ 106.5 AND AKR1B1==< 18.5 THEN Disease=PD_B5-6 
Rule: IF CD82!=< 4.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF DNMT3A==< 3.5 AND HSPA1A!=≥ 6.5 AND PPP2R2D!=≥ 35.5 AND PTK2==< 198.5 AND HHIP==< 11.5 AND TRRAP==< 93.5 THEN Disease=PD_B5-6 
Rule: IF RELB==< 8.5 AND IGBP1!=< 1.5 AND HSF1==< 2.5 AND GNB4!=≥ 49.5 AND GNG12==< 137.5 AND IL23R!=< 0.5 THEN Disease=PD_B3-4 
Rule: IF CD40LG==< 0.5 AND CCL5==< 0.5 AND GNAS!=≥ 850 AND CNR2!=12.5 - 58.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF PEMT==< 2.5 AND CD28==0.5 - 68 AND CREB3L3==< 5.5 AND GNAI2!=0.5 - 2.5 AND TYMP==< 0.5 AND DDB2==< 31.5 THEN Disease=PD_B3-4 
Rule: IF PPP1CA!=< 0.5 AND GNAS!=≥ 850 AND STK11!=≥ 40.5 AND RXRA!=0.5 - 4.5 AND HSPA1A!=≥ 6.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF CYP4Z1!=2.5 - 56.5 AND PPIA==< 248 AND GNAO1!=7.5 - 14.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 THEN Disease=CTR 
Rule: IF DHFR!=< 4.5 AND ARRB1!=≥ 104.5 AND MAPK8==< 171 AND AKR1B1==< 18.5 AND KIF5C!=≥ 106.5 AND JUN==< 2.5 THEN Disease=PD_B5-6 
Rule: IF RELB==< 8.5 AND IGBP1!=< 1.5 AND HSF1==< 2.5 AND GNG12==< 137.5 AND GNB4!=≥ 49.5 AND NQO1==< 25.5 THEN Disease=PD_B3-4 
Rule: IF CD82!=< 4.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND PPARGC1A==< 87.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF FGF16==< 0.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND PTMA==< 140.5 AND AKR1B1!=≥ 1202 AND PPP1CA!=≥ 949 THEN Disease=CTR 
Rule: IF RELB==< 8.5 AND IGBP1!=< 1.5 AND CACNA1A==< 253.5 AND GNB4!=≥ 49.5 AND GNG12==< 137.5 AND CA9==< 5.5 THEN Disease=PD_B3-4 
Rule: IF FGF16!=< 0.5 AND HSPA1A!=≥ 6.5 AND PIK3CA!=≥ 57.5 AND NFATC1!=≥ 65.5 AND PPP1CA!=26.5 - 949 AND GRIA1!=≥ 489.5 THEN Disease=PD_B5-6 
Rule: IF HSPA1A!=≥ 6.5 AND NFATC1!=≥ 65.5 AND CYSLTR1!=< 0.5 AND RNASE1!=8.5 - 620 AND AKR1B1==< 18.5 AND GLI2!=≥ 188 THEN Disease=PD_B5-6 
Rule: IF HSPA1A!=≥ 6.5 AND NFATC1!=≥ 65.5 AND PPIA==< 248 AND PTK2B!=≥ 123.5 AND AKR1B1==< 18.5 AND PPP1CA!=26.5 - 949 THEN Disease=PD_B5-6 
Rule: IF CYSLTR1!=< 0.5 AND VEGFA!=≥ 12.5 AND GNG4!=≥ 77 AND SLC6A3!=≥ 50.5 AND HSF1!=≥ 35.5 AND RNF39==< 15.5 THEN Disease=PD_B3-4 
Rule: IF VEGFA!=≥ 12.5 AND RASSF3==< 159.5 AND TH!=≥ 10.5 AND KISS1==< 50 THEN Disease=PD_B3-4 
Rule: IF TRUE THEN Disease=CTR
#+end_example


#+begin_src python :session myorangesession :results output :exports both
from collections import Counter

# Extract the features and class labels from data
X = data_with_class_discrete.X  # feature matrix
Y = data_with_class_discrete.Y  # class labels

# Evaluate each rule and count class occurrences
for rule in classifier.rule_list:
    covered_examples = rule.evaluate_data(X)  # returns a boolean array of covered examples
    class_counts = Counter(
        str(data_with_class_discrete.domain.class_var.values[int(Y[i])])
        for i in range(len(Y)) if covered_examples[i]
    )

    # Print rule and counts for each class
    print(f"Rule: {rule}")
    for class_value, count in class_counts.items():
        print(f"  {class_value}: {count}")
#+end_src

#+RESULTS:
#+begin_example
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND IL27RA!=10.5 - 32.5 AND S100B==< 142.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 THEN Disease=CTR 
  CTR: 1917
  PD_B5-6: 465
  PD_B3-4: 107
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND IL27RA!=10.5 - 32.5 AND S100B==< 142.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
  CTR: 1932
  PD_B5-6: 476
  PD_B3-4: 112
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND CREB3L3!=5.5 - 40.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
  CTR: 1864
  PD_B5-6: 425
  PD_B3-4: 111
Rule: IF GNAO1!=< 7.5 AND RNF128!=≥ 11.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 THEN Disease=CTR 
  CTR: 1915
  PD_B5-6: 688
  PD_B3-4: 184
Rule: IF RXRA!=< 0.5 AND CYSLTR1!=≥ 6.5 AND PTMA==< 140.5 AND S100B==< 142.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 THEN Disease=CTR 
  CTR: 1887
  PD_B5-6: 651
  PD_B3-4: 133
Rule: IF GNAO1!=< 7.5 AND MAOB==< 12.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND PTMA==< 140.5 THEN Disease=CTR 
  CTR: 1766
  PD_B5-6: 586
  PD_B3-4: 160
Rule: IF RXRA!=< 0.5 AND CNR2!=12.5 - 58.5 AND S100B==< 142.5 AND PTMA==< 140.5 AND PPIA==< 248 AND CALM1==< 113.5 THEN Disease=CTR 
  CTR: 2163
  PD_B5-6: 778
  PD_B3-4: 177
Rule: IF GNAO1!=< 7.5 AND RNF128!=≥ 11.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 1913
  PD_B5-6: 686
  PD_B3-4: 184
Rule: IF GNAO1==< 7.5 AND CYSLTR1!=< 0.5 AND PPP2R2B==< 209.5 AND GSN!=≥ 95.5 AND HSPA1A!=≥ 6.5 AND RXRA!=8.5 - 71.5 THEN Disease=PD_B5-6 
  CTR: 262
  PD_B5-6: 703
  PD_B3-4: 138
Rule: IF RXRA!=< 0.5 AND IL23R!=≥ 9.5 AND CALM1==< 113.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
  CTR: 2410
  PD_B5-6: 1027
  PD_B3-4: 261
Rule: IF PPP2R2B==< 209.5 AND CYP3A4!=< 0.5 AND MAPT!=≥ 88.5 AND NFATC1!=≥ 65.5 AND KAT2B==< 60.5 AND RNASE1!=8.5 - 620 THEN Disease=PD_B5-6 
  CTR: 1141
  PD_B5-6: 1331
  PD_B3-4: 263
Rule: IF DNMT3A!=< 3.5 AND IL23R!=≥ 9.5 AND PPIA==< 248 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND RNASE1!=≥ 620 THEN Disease=CTR 
  CTR: 2213
  PD_B5-6: 908
  PD_B3-4: 251
Rule: IF PPP2R2B==< 209.5 AND AKT1==< 0.5 AND MAPT!=≥ 88.5 AND HSPA1A!=≥ 6.5 AND HHIP==< 11.5 AND RXRA!=8.5 - 71.5 THEN Disease=PD_B5-6 
  CTR: 873
  PD_B5-6: 1295
  PD_B3-4: 299
Rule: IF FGF16==< 0.5 AND GNG7!=< 11.5 AND IL12B!=0.5 - 19 AND GNAS!=≥ 850 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 1381
  PD_B5-6: 545
  PD_B3-4: 142
Rule: IF AR!=17.5 - 232.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
  CTR: 2178
  PD_B5-6: 1123
  PD_B3-4: 340
Rule: IF HSPA1A==< 0.5 AND CYSLTR1!=< 0.5 AND RNASE1==< 8.5 AND GNAO1!=≥ 157.5 AND ARRB1!=≥ 104.5 AND NFATC1!=≥ 65.5 THEN Disease=PD_B5-6 
  CTR: 1571
  PD_B5-6: 1549
  PD_B3-4: 325
Rule: IF GRIA3!=31.5 - 272 AND PPIA==< 248 AND GNAS!=≥ 850 AND CCL5==< 0.5 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
  CTR: 1927
  PD_B5-6: 1006
  PD_B3-4: 306
Rule: IF NFATC1!=< 4.5 AND CNR2!=12.5 - 58.5 AND GNAS!=≥ 850 THEN Disease=CTR 
  CTR: 1623
  PD_B5-6: 446
  PD_B3-4: 107
Rule: IF HSPA1A==< 0.5 AND CYSLTR1!=< 0.5 AND NFATC1!=≥ 65.5 AND RNASE1==< 8.5 AND ARRB1!=≥ 104.5 AND NR3C1==< 130.5 THEN Disease=PD_B5-6 
  CTR: 1676
  PD_B5-6: 1590
  PD_B3-4: 334
Rule: IF HSPA1A!=< 0.5 AND KAT5==< 1.5 AND CA9==< 5.5 AND VEGFA!=≥ 12.5 AND CYSLTR1!=< 0.5 AND TGFB1==< 30.5 THEN Disease=PD_B3-4 
  CTR: 301
  PD_B5-6: 242
  PD_B3-4: 196
Rule: IF AR!=17.5 - 232.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 2177
  PD_B5-6: 1122
  PD_B3-4: 340
Rule: IF GRIA3!=31.5 - 272 AND PPIA==< 248 AND GNAS!=≥ 850 AND C5==< 83.5 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 THEN Disease=CTR 
  CTR: 2177
  PD_B5-6: 1210
  PD_B3-4: 353
Rule: IF GNB4==6.5 - 49.5 AND HHIP==< 11.5 AND NCOA1==< 166.5 AND NR3C1==< 130.5 AND PTK2B!=≥ 123.5 AND HSPA1A!=≥ 6.5 THEN Disease=PD_B5-6 
  CTR: 944
  PD_B5-6: 995
  PD_B3-4: 195
Rule: IF PPP2R2B==< 209.5 AND PIK3CA==2.5 - 57.5 AND NFATC1!=≥ 65.5 AND APP==< 132.5 AND ARRB1!=≥ 104.5 AND BCL2L1!=≥ 28.5 THEN Disease=PD_B5-6 
  CTR: 1399
  PD_B5-6: 1492
  PD_B3-4: 306
Rule: IF NFATC1!=< 4.5 AND RNASEH2A!=0.5 - 13.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND AKR1B1!=≥ 1202 AND AR!=≥ 232.5 THEN Disease=CTR 
  CTR: 1543
  PD_B5-6: 487
  PD_B3-4: 106
Rule: IF HSPA1A!=< 0.5 AND KAT5==< 1.5 AND CA9==< 5.5 AND IL23R!=< 0.5 AND TGFB1==< 30.5 AND VEGFA!=≥ 12.5 THEN Disease=PD_B3-4 
  CTR: 279
  PD_B5-6: 226
  PD_B3-4: 188
Rule: IF RNASE1!=< 8.5 AND VEGFA!=≥ 12.5 AND GNG4!=≥ 77 AND DDB2==< 31.5 AND RXRA!=≥ 71.5 AND GATA3==< 28.5 THEN Disease=PD_B3-4 
  CTR: 164
  PD_B5-6: 103
  PD_B3-4: 113
Rule: IF AR!=17.5 - 232.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 AND AKR1B1!=≥ 1202 AND EGF!=≥ 84.5 THEN Disease=CTR 
  CTR: 2151
  PD_B5-6: 1122
  PD_B3-4: 338
Rule: IF PTK2==< 198.5 AND PIK3CA==2.5 - 57.5 AND HSPA1A!=≥ 6.5 AND NR3C1==< 130.5 AND NFATC1!=≥ 65.5 AND PPP2R2D!=≥ 35.5 THEN Disease=PD_B5-6 
  CTR: 1708
  PD_B5-6: 1680
  PD_B3-4: 362
Rule: IF FGF16==< 0.5 AND GNG7!=< 11.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND AKR1B1!=≥ 1202 AND SLC18A2==< 44 THEN Disease=CTR 
  CTR: 1629
  PD_B5-6: 713
  PD_B3-4: 190
Rule: IF HSPA1A!=< 0.5 AND KAT5==< 1.5 AND CA9==< 5.5 AND TGFB1==< 30.5 AND IL23R!=< 0.5 AND GNG12==< 137.5 THEN Disease=PD_B3-4 
  CTR: 285
  PD_B5-6: 233
  PD_B3-4: 190
Rule: IF TNFSF10!=< 0.5 AND ARRB1!=≥ 104.5 AND HSPA1A!=≥ 6.5 AND KIF5C!=≥ 106.5 AND NR3C1==< 130.5 AND JDP2!=≥ 37.5 THEN Disease=PD_B5-6 
  CTR: 1278
  PD_B5-6: 1290
  PD_B3-4: 321
Rule: IF RXRA!=< 0.5 AND RXRA!=0.5 - 4.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND FGF13!=≥ 335.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 2079
  PD_B5-6: 673
  PD_B3-4: 154
Rule: IF ARRB1!=< 5.5 AND HLA-DQB1==< 0.5 AND GNAO1!=7.5 - 14.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND PPIA==< 248 THEN Disease=CTR 
  CTR: 1305
  PD_B5-6: 477
  PD_B3-4: 105
Rule: IF PPP2R2B==< 209.5 AND RNASE1==< 8.5 AND NFATC1!=≥ 65.5 AND PPP2R2D!=≥ 35.5 AND PTK2==< 198.5 AND HSPA1A!=≥ 6.5 THEN Disease=PD_B5-6 
  CTR: 1901
  PD_B5-6: 1723
  PD_B3-4: 346
Rule: IF RNASE1!=< 8.5 AND VEGFA!=≥ 12.5 AND GNG4!=≥ 77 AND DDB2==< 31.5 AND RXRA!=≥ 71.5 AND CNR2!=≥ 58.5 THEN Disease=PD_B3-4 
  CTR: 165
  PD_B5-6: 104
  PD_B3-4: 113
Rule: IF TNFSF10==< 0.5 AND CD40LG==< 0.5 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND SRF!=≥ 45.5 THEN Disease=CTR 
  CTR: 1200
  PD_B5-6: 600
  PD_B3-4: 195
Rule: IF DHFR!=< 4.5 AND ARRB1!=≥ 104.5 AND HSPA1A!=≥ 6.5 AND MAPK8==< 171 AND KIF5C!=≥ 106.5 AND AKR1B1==< 18.5 THEN Disease=PD_B5-6 
  CTR: 842
  PD_B5-6: 1045
  PD_B3-4: 195
Rule: IF CD82!=< 4.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 1690
  PD_B5-6: 698
  PD_B3-4: 154
Rule: IF DNMT3A==< 3.5 AND HSPA1A!=≥ 6.5 AND PPP2R2D!=≥ 35.5 AND PTK2==< 198.5 AND HHIP==< 11.5 AND TRRAP==< 93.5 THEN Disease=PD_B5-6 
  CTR: 637
  PD_B5-6: 985
  PD_B3-4: 236
Rule: IF RELB==< 8.5 AND IGBP1!=< 1.5 AND HSF1==< 2.5 AND GNB4!=≥ 49.5 AND GNG12==< 137.5 AND IL23R!=< 0.5 THEN Disease=PD_B3-4 
  CTR: 665
  PD_B5-6: 731
  PD_B3-4: 294
Rule: IF CD40LG==< 0.5 AND CCL5==< 0.5 AND GNAS!=≥ 850 AND CNR2!=12.5 - 58.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 1772
  PD_B5-6: 896
  PD_B3-4: 287
Rule: IF PEMT==< 2.5 AND CD28==0.5 - 68 AND CREB3L3==< 5.5 AND GNAI2!=0.5 - 2.5 AND TYMP==< 0.5 AND DDB2==< 31.5 THEN Disease=PD_B3-4 
  CTR: 412
  PD_B5-6: 549
  PD_B3-4: 248
Rule: IF PPP1CA!=< 0.5 AND GNAS!=≥ 850 AND STK11!=≥ 40.5 AND RXRA!=0.5 - 4.5 AND HSPA1A!=≥ 6.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 1028
  PD_B5-6: 418
  PD_B3-4: 96
Rule: IF CYP4Z1!=2.5 - 56.5 AND PPIA==< 248 AND GNAO1!=7.5 - 14.5 AND GNAS!=≥ 850 AND RNASE1!=≥ 620 THEN Disease=CTR 
  CTR: 1902
  PD_B5-6: 1043
  PD_B3-4: 303
Rule: IF DHFR!=< 4.5 AND ARRB1!=≥ 104.5 AND MAPK8==< 171 AND AKR1B1==< 18.5 AND KIF5C!=≥ 106.5 AND JUN==< 2.5 THEN Disease=PD_B5-6 
  CTR: 831
  PD_B5-6: 1035
  PD_B3-4: 209
Rule: IF RELB==< 8.5 AND IGBP1!=< 1.5 AND HSF1==< 2.5 AND GNG12==< 137.5 AND GNB4!=≥ 49.5 AND NQO1==< 25.5 THEN Disease=PD_B3-4 
  CTR: 889
  PD_B5-6: 863
  PD_B3-4: 346
Rule: IF CD82!=< 4.5 AND RNASE1!=≥ 620 AND GNAS!=≥ 850 AND AKR1B1!=≥ 1202 AND PPARGC1A==< 87.5 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 1625
  PD_B5-6: 688
  PD_B3-4: 142
Rule: IF FGF16==< 0.5 AND GNAS!=≥ 850 AND PPIA==< 248 AND PTMA==< 140.5 AND AKR1B1!=≥ 1202 AND PPP1CA!=≥ 949 THEN Disease=CTR 
  CTR: 2196
  PD_B5-6: 1194
  PD_B3-4: 330
Rule: IF RELB==< 8.5 AND IGBP1!=< 1.5 AND CACNA1A==< 253.5 AND GNB4!=≥ 49.5 AND GNG12==< 137.5 AND CA9==< 5.5 THEN Disease=PD_B3-4 
  CTR: 1106
  PD_B5-6: 1027
  PD_B3-4: 396
Rule: IF FGF16!=< 0.5 AND HSPA1A!=≥ 6.5 AND PIK3CA!=≥ 57.5 AND NFATC1!=≥ 65.5 AND PPP1CA!=26.5 - 949 AND GRIA1!=≥ 489.5 THEN Disease=PD_B5-6 
  CTR: 824
  PD_B5-6: 937
  PD_B3-4: 245
Rule: IF HSPA1A!=≥ 6.5 AND NFATC1!=≥ 65.5 AND CYSLTR1!=< 0.5 AND RNASE1!=8.5 - 620 AND AKR1B1==< 18.5 AND GLI2!=≥ 188 THEN Disease=PD_B5-6 
  CTR: 1930
  PD_B5-6: 1843
  PD_B3-4: 481
Rule: IF HSPA1A!=≥ 6.5 AND NFATC1!=≥ 65.5 AND PPIA==< 248 AND PTK2B!=≥ 123.5 AND AKR1B1==< 18.5 AND PPP1CA!=26.5 - 949 THEN Disease=PD_B5-6 
  CTR: 2630
  PD_B5-6: 2149
  PD_B3-4: 578
Rule: IF CYSLTR1!=< 0.5 AND VEGFA!=≥ 12.5 AND GNG4!=≥ 77 AND SLC6A3!=≥ 50.5 AND HSF1!=≥ 35.5 AND RNF39==< 15.5 THEN Disease=PD_B3-4 
  CTR: 2211
  PD_B5-6: 1910
  PD_B3-4: 621
Rule: IF VEGFA!=≥ 12.5 AND RASSF3==< 159.5 AND TH!=≥ 10.5 AND KISS1==< 50 THEN Disease=PD_B3-4 
  CTR: 3034
  PD_B5-6: 2244
  PD_B3-4: 717
Rule: IF TRUE THEN Disease=CTR 
  CTR: 3358
  PD_B5-6: 2305
  PD_B3-4: 722
#+end_example

* do we want to extract min graph of nodes in subgroup rule?





